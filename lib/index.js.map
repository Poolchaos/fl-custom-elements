{"version":3,"sources":["../src/index.js"],"names":["uuid","require","__custom_elements__","CustomElement","config","init","setupUsables","findInstances","console","log","shadowRoots","hosts","tagName","template","viewModel","_elements_","document","querySelectorAll","length","render","hasSource","el","renderSingleElement","_id","addHost","createShadowDom","then","$","load","script","createElement","type","src","appendChild","id","Promise","resolve","reject","shadowRoot","attachShadow","mode","e","CustomComponent","exports","customElement"],"mappings":"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","file":"index.js","sourcesContent":["const uuid = require('uuid/v1');\r\n\r\nlet __custom_elements__ = {};\r\n\r\nclass CustomElement {\r\n  constructor(config) {\r\n    this.init(config);\r\n  }\r\n\r\n  init(config) {\r\n    this.setupUsables(config);\r\n    this.findInstances();\r\n  }\r\n\r\n  setupUsables(config) {\r\n    console.log(' config >>>> ', config);\r\n    this.shadowRoots = {};\r\n    this.hosts = {};\r\n    this.tagName = config.tagName;\r\n    this.template = config.template;\r\n    this.viewModel = config.viewModel;\r\n  }\r\n\r\n  findInstances() {\r\n    const _elements_ = document.querySelectorAll(this.tagName);\r\n\r\n    if (_elements_ && _elements_.length) {\r\n      this.render(_elements_);\r\n    }\r\n  }\r\n\r\n  render(_elements_) {\r\n    if (this.hasSource()) {\r\n      for (let el of _elements_) {\r\n        this.renderSingleElement(el);\r\n      }\r\n    }\r\n  }\r\n\r\n  renderSingleElement(el) {\r\n    const _id = uuid();\r\n\r\n    this.addHost(_id, el);\r\n    this.createShadowDom(_id) //\r\n      .then(\r\n        () => {\r\n          console.log('loading new view', this.shadowRoots[_id]);\r\n          $(this.shadowRoots[_id]).load(this.template);\r\n\r\n          console.log(' loading >>>> ', this.template);\r\n          var script = document.createElement('script');\r\n          script.type = 'text/javascript';\r\n          script.src = this.viewModel;\r\n          this.shadowRoots[_id].appendChild(script);\r\n        },\r\n        () => {\r\n          console.log(' :::: loading >>>> ', this.template);\r\n          $(el).load(this.template);\r\n        }\r\n      );\r\n  }\r\n\r\n  addHost(_id, el) {\r\n    el.id = _id;\r\n    this.hosts[_id] = el;\r\n  }\r\n\r\n  createShadowDom(_id) {\r\n    return new Promise((resolve, reject) => {\r\n      if (this.shadowRoot) {\r\n        console.log('%c shadow root cannot be created on a host which already hosts a shadow tree. ', 'color:#9D2933;');\r\n        reject();\r\n        return;\r\n      }\r\n\r\n      try {\r\n        this.shadowRoots[_id] = this.hosts[_id].attachShadow({ mode: 'open' });\r\n        resolve();\r\n      } catch (e) {\r\n        console.log('%c something is wrong with your custom element! this is not a problem with flaap-gallery, but between the chair and the computer. ', 'color:#9D2933;');\r\n        reject();\r\n      }\r\n    });\r\n  }\r\n\r\n  hasSource() {\r\n    if (this.template) return true;\r\n    console.log('%c no source specified for component ', 'color:#9D2933;');\r\n    return;\r\n  }\r\n}\r\n\r\nclass CustomComponent {\r\n  constructor(config) {\r\n    if (__custom_elements__[config.tagName]) {\r\n      __custom_elements__[config.tagName].init();\r\n      return;\r\n    }\r\n    __custom_elements__[config.tagName] = new CustomElement(config);\r\n  }\r\n}\r\n\r\nexports.customElement = CustomComponent;\r\n"]}